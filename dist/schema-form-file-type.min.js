/*! angular-schema-file-type 2015-04-09 */
"use strict";var ngSchemaFormFileType=angular.module("ngSchemaFormFileType",["angularFileUpload"]);angular.module("schemaForm").config(["schemaFormProvider","schemaFormDecoratorsProvider","sfPathProvider",function(a,b){b.addMapping("bootstrapDecorator","files","files.html");var c=function(a,b){"array"===b.type&&"files"===b.format&&(void 0!==b.items.properties.size&&void 0!==b.items.properties.size.maximum&&(b.items.properties.size.validationMessage={103:"This file is too large. Maximum size allowed is "+Math.floor(b.items.properties.size.maximum/1e3)+" ko."}),void 0!==b.items.properties.extension&&void 0!==b.items.properties.extension["enum"]&&(b.items.properties.extension.validationMessage={1:"Wrong file extension. Allowed extensions are "+b.items.properties.extension["enum"]+"."}))};a.defaults.array.unshift(c)}]),ngSchemaFormFileType.directive("ngSchemaFile",["$upload","$timeout","$q",function(a,b,c){return{restrict:"A",scope:!0,require:"ngModel",link:function(d){d.fileReaderSupported=null!=window.FileReader&&(null==window.FileAPI||0!=FileAPI.html5),d.upload=function(a){var b=d.form.key[0];d.model[b]=[];for(var c=0;c<a.length;c++){var e=a[c],f=e.name.split(".").pop();d.model[b].push({token:c.toString(),extension:f,size:e.size,name:e.name,progress:0}),d.generateThumb(e,c).then(function(a){d.model[b][a.i].dataUrl=a.dataUrl}),d.uploadFile(e,b,c).then(function(a){d.model[b][a.index].token=a.token,d.model[b][a.index].extension=a.extension,d.model[b][a.index].size=a.size})}d.revalidate()},d.uploadFile=function(b,e,f){var g=c.defer();return a.upload({url:d.form.endpoint,file:b,fields:{index:f}}).progress(function(a){var b=parseInt(100*a.loaded/a.total);a.config.file.filesProgress=b,d.model[e][a.config.fields.index].progress=b}).success(function(a){g.resolve(a)}),g.promise},d.generateThumb=function(a,e){var f=c.defer();return null!=a&&d.fileReaderSupported&&a.type.indexOf("image")>-1&&b(function(){var c=new FileReader;c.readAsDataURL(a),c.onload=function(c){b(function(){a.dataUrl=c.target.result,f.resolve({dataUrl:a.dataUrl,i:e})})}}),f.promise},d.revalidate=function(){b(function(){d.$broadcast("schemaFormValidate")},100)}}}}]);
angular.module('ngSchemaFormFileType').run(['$templateCache', function($templateCache) {  'use strict';

  $templateCache.put('files.html',
    "<style type=\"text/css\">.file-objects .form-control-feedback,.file-objects label,.file-objects legend,.file-objects select, .file-objects input {display: none;}.noProgressTransition {transition: none;}</style><div ng-schema-file ng-model=\"$$value$$\" class=\"file-objects\"><div sf-array=\"form\" class=\"schema-form-array {{form.htmlClass}}\" ng-model=\"$$value$$\" ng-model-options=\"form.ngModelOptions\"><h3 ng-show=\"form.title && form.notitle !== true\">{{ form.title }}</h3><div class=\"btn btn-default\" ng-model=\"files\" ng-file-select ng-file-change=\"upload($files)\" ng-multiple=\"!(form.schema.minItems == 1 && form.schema.maxItems == 1)\">{{ form.button_label }}</div><ol class=\"list-group\" ng-model=\"modelArray\" ui-sortable style=\"margin-top: 20px\"><li class=\"list-group-item {{form.fieldHtmlClass}}\" ng-repeat=\"item in modelArray track by $index\"><button ng-hide=\"form.readonly\" ng-click=\"deleteFromArray($index); revalidate();\" style=\"position: relative; z-index: 20\" type=\"button\" class=\"close pull-right\"><span aria-hidden=\"true\">&times;</span><span class=\"sr-only\">Close</span></button><div class=\"media-left\"><img class=\"media-object\" ng-src=\"{{item.dataUrl}}\" alt=\"\" style=\"max-width: 100px\" ng-if=\"item.dataUrl\"></div><h5>{{ item.name }}</h5><div class=\"progress\" style=\"height: 20px\"><div class=\"progress-bar progress-bar-success\" role=\"progressbar\" aria-valuenow=\"{{ item.progress }}\" aria-valuemin=\"0\" aria-valuemax=\"100\" ng-class=\"item.progress==100?'noProgressTransition':''\" style=\"width: {{ item.progress }}%\">{{ item.progress }}% Complete (success)</div></div><sf-decorator ng-init=\"arrayIndex = $index\" form=\"copyWithIndex($index)\"></sf-decorator></li></ol><div class=\"help-block\" style=\"color: #e74c3c\" ng-show=\"(hasError() && errorMessage(schemaError())) || form.description\" ng-bind-html=\"(hasError() && errorMessage(schemaError())) || form.description\"></div></div></div>"
  );
}]);